# Explore Top Predictors from Random Forest Model

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
```

## Goal

Downstream processing of results from the Random Forest (RF) method. In this document, we explore the prediction model to identify the top predictors as well as possible interactions.

## Top predictors for COVID

```{r}
dd.impor=read.csv("/data/liq4/CCDGS_y2024/codeathon/rf_results/ph_covid_wCov/first_covRF_rf_impor.csv", header=T, as.is=T)
str(dd.impor)
hist(dd.impor$importance)
topPred = dd.impor %>% select(splitVar, importance) %>% arrange(desc(importance)) %>% head()
topPred
```

```{r}
rna_pred = dd.impor %>% select(splitVar, importance) %>% arrange(desc(importance))%>% head(n=30)
rna_pred = rna_pred[-1, ]
plot(1:nrow(rna_pred), rna_pred$importance, xlab="RNA-seq Index", ylab="Based on Gini Index", main="Improtanct of Top RNA-seq To Predict COVID Risk")
```

## How often a variable is picked in a forest

```{r}
dd.split=read.csv("/data/liq4/CCDGS_y2024/codeathon/rf_results/ph_covid_wCov/first_covRF_rf_split.csv", header=T, as.is=T)
str(dd.split)
```

Find out the most picked variables

```{r}
tb.splitv = sort(table(dd.split$splitVar), decreasing = T)
hist(log10(tb.splitv))
```

### Ref:

For RF package ranger, <https://cran.r-project.org/web/packages/ranger/index.html>
